<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo</title>
    <link rel="stylesheet" href="css/style.css"> </head>
<body>
    <div class="wrapper">
        <div class="content">
    <h1>Meine Aufgaben</h1>

    <div class="taskliste">
        <?php if (isset($tasks) && count($tasks) > 0): ?>
            <?php foreach ($tasks as $task): ?>
                <div class='task' id="task-<?= htmlspecialchars($task['id']) ?>"> <p><?= htmlspecialchars($task['task']) ?></p>
                    <input type="text" class="edit-input" data-id='<?= htmlspecialchars($task['id']) ?>' value="<?= htmlspecialchars($task['task']) ?>" style="display:none;">
                    <button class="save" data-id='<?= htmlspecialchars($task['id']) ?>' style="display:none;">Speichern"></button>
                    <button class='edit' data-id='<?= htmlspecialchars($task['id']) ?>'>Bearbeiten</button>
                    <button class='delete' data-id='<?= htmlspecialchars($task['id']) ?>'>Löschen</button>
                </div>
            <?php endforeach; ?>
        <?php else: ?>
            <p>Keine Aufgaben vorhanden.</p>
        <?php endif; ?>
    </div>

    <form action="index.php" method="POST" id="addTaskForm"> 
        <input type="hidden" name="action" value="add_task"> <input type="text" name="task" id="task" placeholder="Aufgabe hinzufügen...">
        <button id="addTask" type="submit">Hinzufügen</button>
    </form>
    </div>

    <footer>
        &copy; <?= date('Y') ?> Todo App. All rights reserved.
    </footer>
    </div>
    <?php
        // OPTIM: Es gibt eine Möglichkeit die einen Rerouter zu benutzen, um die URL nicht im JS zu haben.
        $deleteBaseUrl = APP_ROOT . '/src/delete_task.php?id=';
        $updateBaseUrl = APP_ROOT . '/src/update_task.php?id=';    // Basis-URL zum Aktualisieren (ID wird später oder im Body hinzugefügt)
    ?>
    <script>
        const DELETE_TASK_URL_BASE = <?php echo json_encode($deleteBaseUrl); ?>;
        const UPDATE_TASK_URL_BASE = <?php echo json_encode($updateBaseUrl); ?>;
    </script>

    <script src="js/script.js"></script> </body>
</html>
